<div class="expenses-container">
  <!-- Indicador de carregamento -->
  <div class="loading-overlay" *ngIf="isLoading">
    <div class="spinner"></div>
    <p>Carregando despesas...</p>
  </div>

  <!-- Conte√∫do de despesas -->
  <div class="expenses-content" [class.loading]="isLoading">
    <div class="page-header flex justify-between align-center mb-lg">
      <h1 class="page-title">Despesas</h1>
      <button class="btn btn-primary add-expense-btn" (click)="openAddExpenseModal()">
        <span class="btn-icon">+</span>
        <span class="btn-text">Adicionar Despesa</span>
      </button>
    </div>

    <!-- Cart√£o de resumo -->
    <div class="card summary-card">
      <div class="card-content">
        <h2 class="card-title">Despesas Totais</h2>
        <p class="total-amount">{{ totalExpenses$ | async | currency }}</p>
        <p class="period-label">{{ selectedPeriod === 'all' ? 'Todo o per√≠odo' :
          selectedPeriod === 'today' ? 'Hoje' :
          selectedPeriod === 'week' ? 'Esta semana' :
          selectedPeriod === 'month' ? 'Este m√™s' :
          'Este ano' }}</p>
      </div>
    </div>

    <!-- Filtros -->
    <div class="filters-section mt-lg">
      <div class="card">
        <div class="card-content">
          <h2 class="card-title">Filtros</h2>

          <div class="filter-options flex gap-lg">
            <!-- Filtro de per√≠odo -->
            <div class="filter-group">
              <label>Per√≠odo</label>
              <div class="period-buttons flex gap-sm">
                <button
                  *ngFor="let period of ['today', 'week', 'month', 'year', 'all']"
                  [class.active]="selectedPeriod === period"
                  (click)="filterByPeriod(period)">
                  {{ period === 'today' ? 'Hoje' :
                     period === 'week' ? 'Semana' :
                     period === 'month' ? 'M√™s' :
                     period === 'year' ? 'Ano' :
                     'Todos' }}
                </button>
              </div>
            </div>

            <!-- Filtro de categoria -->
            <div class="filter-group">
              <label>Categoria</label>
              <select class="form-control">
                <option value="">Todas as Categorias</option>
                <!-- Ser√° preenchido com categorias reais -->
                <option value="food">Alimenta√ß√£o</option>
                <option value="transportation">Transporte</option>
                <option value="utilities">Servi√ßos P√∫blicos</option>
                <!-- Mais categorias -->
              </select>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Lista de despesas -->
    <div class="card expenses-list-card mt-lg">
      <div class="card-content">
        <div class="list-header flex justify-between align-center mb-md">
          <h2 class="card-title">Transa√ß√µes de Despesas</h2>

          <!-- Op√ß√µes de ordena√ß√£o -->
          <div class="sort-options flex align-center gap-sm">
            <label>Ordenar por:</label>
            <select class="form-control">
              <option value="date">Data</option>
              <option value="amount">Valor</option>
              <option value="category">Categoria</option>
            </select>

            <button class="sort-direction-btn" (click)="sortDirection = sortDirection === 'asc' ? 'desc' : 'asc'" aria-label="Dire√ß√£o de ordena√ß√£o">
              <span *ngIf="sortDirection === 'asc'">‚Üë</span>
              <span *ngIf="sortDirection === 'desc'">‚Üì</span>
            </button>
          </div>
        </div>

        <!-- Tabela de despesas -->
        <div class="expenses-table">
          <div class="table-header">
            <div class="header-cell date-cell">Data</div>
            <div class="header-cell description-cell">Descri√ß√£o</div>
            <div class="header-cell category-cell">Categoria</div>
            <div class="header-cell amount-cell">Valor</div>
            <div class="header-cell actions-cell">A√ß√µes</div>
          </div>

          <ng-container *ngIf="(expenses$ | async) as expenses">
            <div class="empty-state text-center mt-lg" *ngIf="expenses.length === 0">
              <p>Nenhuma despesa encontrada para os filtros selecionados.</p>
              <button class="btn btn-primary mt-md" (click)="openAddExpenseModal()">Adicionar Sua Primeira Despesa</button>
            </div>

            <div class="table-row" *ngFor="let expense of expenses">
              <div class="cell date-cell">{{ expense.date | date:'dd/MM/yyyy' }}</div>
              <div class="cell description-cell">{{ expense.description }}</div>
              <div class="cell category-cell">
                <span class="category-badge" [style.backgroundColor]="expense.category.color + '33'">
                  {{ expense.category.name }}
                </span>
              </div>
              <div class="cell amount-cell">{{ expense.amount | currency }}</div>
              <div class="cell actions-cell">
                <button class="action-btn edit-btn" title="Editar">‚úèÔ∏è</button>
                <button class="action-btn delete-btn" title="Excluir" (click)="deleteExpense(expense.id)">üóëÔ∏è</button>
              </div>
            </div>
          </ng-container>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal de Adicionar Despesa (placeholder) -->
  <div class="modal-overlay" *ngIf="showAddExpenseModal" (click)="closeAddExpenseModal()">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h2>Adicionar Nova Despesa</h2>
        <button class="close-btn" (click)="closeAddExpenseModal()" aria-label="Fechar">√ó</button>
      </div>

      <div class="modal-body">
        <!-- Formul√°rio de transa√ß√£o ser√° colocado aqui -->
        <p>Placeholder do formul√°rio de despesa</p>
      </div>

      <div class="modal-footer">
        <button class="btn btn-secondary" (click)="closeAddExpenseModal()">Cancelar</button>
        <button class="btn btn-primary">Salvar Despesa</button>
      </div>
    </div>
  </div>
</div>
